<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fi" xml:lang="fi"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kirjallisuuskatsauksen ohje - 15&nbsp; OpenAlex</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tiet-base.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Ei tuloksia",
    "search-matching-documents-text": "tulokset",
    "search-copy-link-title": "Kopioi linkki hakuun",
    "search-hide-matches-text": "Piilota loput tulokset",
    "search-more-match-text": "tulos tässä dokumentissa",
    "search-more-matches-text": "tulosta tässä dokumentissa",
    "search-clear-button-title": "Tyhjennä",
    "search-detached-cancel-button-title": "Peruuta",
    "search-submit-button-title": "Lähetä",
    "search-label": "Hae"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Kirjallisuuskatsauksen ohje</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Hae"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Vaihda navigointi" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Etusivu</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-kriteeristö" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Kriteeristö</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-kriteeristö">    
        <li>
    <a class="dropdown-item" href="./kriteeristo.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Yleisesti kriteeristöstä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-aika.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Julkaisuaika</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-metodologia.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Metodologia</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-kohderyhma.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Kohderyhmä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-maantiede.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Maantiede</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-tutkimuskieli.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tutkimuskieli</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-aineistotyyppi.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Aineistotyyppi</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./krit-tietokannat.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tietokannat</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tietolähteet" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tietolähteet</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tietolähteet">    
        <li>
    <a class="dropdown-item" href="./tietolahteet.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Yleisesti tietolähteistä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tiet-scopus.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Scopus</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tiet-webofscience.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Web of Science</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tiet-proquest.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">ProQuest</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tiet-base.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bielefeld Academic Search Engine (BASE)</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tiet-openalex.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">OpenAlex</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hakujen-suorittaminen" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hakujen suorittaminen</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hakujen-suorittaminen">    
        <li>
    <a class="dropdown-item" href="./hakeminen.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hakujen suorittaminen</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dokumentointi" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Dokumentointi</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dokumentointi">    
        <li>
    <a class="dropdown-item" href="./dokumentointi.html" rel="" target="">
 <span class="dropdown-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dokumentointi</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./hakulausekkeet.html" rel="" target="">
 <span class="menu-text">Hakulausekkeet</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tiet-openalex.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">OpenAlex</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tietolahteet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Yleisesti tietolähteistä</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tiet-scopus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Scopus</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tiet-webofscience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Web of Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tiet-proquest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">ProQuest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tiet-base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bielefeld Academic Search Engine (BASE)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tiet-openalex.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">OpenAlex</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sisällysluettelo</h2>
   
  <ul>
  <li><a href="#hakulausekkeen-muodostaminen" id="toc-hakulausekkeen-muodostaminen" class="nav-link active" data-scroll-target="#hakulausekkeen-muodostaminen"><span class="header-section-number">15.1</span> Hakulausekkeen muodostaminen</a></li>
  <li><a href="#tulosten-tallentaminen" id="toc-tulosten-tallentaminen" class="nav-link" data-scroll-target="#tulosten-tallentaminen"><span class="header-section-number">15.2</span> Tulosten tallentaminen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tiet-openalex" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">OpenAlex</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Osoite:</strong> <a href="https://openalex.org/" class="uri">https://openalex.org/</a></p>
<p><strong>Sisältö</strong>: Yleinen tutkimuskirjallisuus</p>
<p><strong>Saatavuus:</strong> Avoimesti saatavilla (mutta julkaisut voivat olla rajattuja)</p>
<p><strong>Aineistotyyppi</strong>: Vertaisarvioitu tutkimusraportti, harmaa kirjallisuus</p>
<p><strong>Alusta:</strong> Itse kehitetty</p>
<p><strong>Huomioita</strong>: OpenAlexista haetaan vain vertaisarvioituja tutkimusraportteja.</p>
<hr>
<p><strong>OpenAlex</strong> toimii API-periaattella. Tämä tarkoittaa, että OpenAlexin hakua ei suoriteta visuaalisessa hakukentässä (verkkosivulla, kuten useimmat muut hakukoneet), vaan haku toteutetaan kirjoittamalla hakukriteerit verkko-osoitteeseen.</p>
<p><strong>Ole hyvin tarkkana verkko-osoitteen muodostamisen</strong> kanssa! Emme voi “tarkistaa” jälkikäteen, menikö haku oikein muulla tavalla, kuin lukemalla rakennettu verkko-osoite.</p>
<p>Verkko-osoite palauttaa JSON-tiedoston selaimessa, joka tallennetaan omalle koneelle ja käsitellään hyvin samankaltaisella tavalla kuin BASE:n tulokset (ks. <a href="tiet-base.html"><span>Luku&nbsp;14</span></a>).</p>
<section id="hakulausekkeen-muodostaminen" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="hakulausekkeen-muodostaminen"><span class="header-section-number">15.1</span> Hakulausekkeen muodostaminen</h2>
<p>OpenAlexissa on seuraavat hakusäännöt:</p>
<ul>
<li><p>Boolelaiset algebrasanat AND, OR ja NOT toimivat kuten yleensä.</p></li>
<li><p>Villikortteja ei voi käyttää: OpenAlex muodostaa sanarunkoja ja hakee samankaltaisia sanoja automaattisesti, eikä tätä toimintoa voi asettaa pois päältä.</p></li>
<li><p>Erilaisilla suodattimilla voidaan rajata hakutuloksia:</p>
<ul>
<li><p><code>filter=</code>-sanalla ilmaistaan, että seuraavaksi tulee suodattimia. Tämä on pakollinen suodattimien käytössä!</p></li>
<li><p>Yhdelle filtterille (esim. dokumenttityyppi) voi antaa useita rajauksia. Nämä erotetaan toisistaan boolelaisella algebralla, mutta erityismerkeillä: <code>+</code> (<code>AND</code>), <code>|</code> (<code>OR</code>) ja <code>!</code> (<code>NOT</code>).</p></li>
<li><p><code>from_publication_date:</code> määrittelee aikarajauksen alun. Kirjoitetaan muodossa <code>YYYY-MM-DD</code>, esimerkki: <code>from_publication_date:2010-01-01</code></p></li>
<li><p><code>to_publication_date:</code> määrittelee aikarajauksen lopun. Kirjoitetaan muodossa <code>YYYY-MM-DD</code>, esimerkki: <code>to_publication_date:2023-09-30</code></p></li>
<li><p><code>type_crossref:</code> määrittelee dokumenttityypin. Meidän rajaukset ovat usein <code>journal-article</code>, <code>monograph</code> ja <code>report</code>.</p></li>
</ul></li>
</ul>
<hr>
<p><strong>OpenAlexin hakuosoite näyttää seuraavalta:</strong></p>
<p><code>https://api.openalex.org/works?search=("fire rescue" OR firefighter OR "rescue service" OR "emergency respon" OR "emergency personnel" OR "emergency medic" OR "ambulance") AND (discriminat OR harass OR violen OR "improper behavior" OR equali OR "non-discriminat" OR equit)&amp;filter=from_publication_date:2010-01-01,to_publication_date:2023-09-30,type_crossref:journal-article|monograph|report&amp;per_page=200&amp;select=title,publication_year,doi&amp;page=1</code></p>
<p>Tätä on helpompi lukea, jos erittelen sen riveihin. Muista kuitenkin, että osoite pitää olla ilman rivejä kun se suoritetaan selaimessa!</p>
<p>Ensin annetaan pääosoite OpenAlexin servereille: <code>https://api.openalex.org/</code></p>
<p>Sitten pyydetään haettavaksi teoksia: <code>works?</code></p>
<p>Sitten ilmaistaan hakulauseke <code>search</code>-toiminnolla: <code>search=("fire rescue" OR firefighter OR "rescue service" OR "emergency respon" OR "emergency personnel" OR "emergency medic" OR "ambulance") AND (discriminat OR harass OR violen OR "improper behavior" OR equali OR "non-discriminat" OR equit)</code></p>
<p>Seuraavaksi voidaan listata filttereitä <code>filter</code>-toiminnolla. Huomaa &amp;-merkki, joka yhdistää filtterit osaksi hakua: <code>&amp;filter=</code></p>
<p>Yksittäiset filtterit listataan aina muodossa <code>avainsana:asetukset</code>, joten koko filtteristä tulee: <code>&amp;filter=``from_publication_date:2010-01-01,to_publication_date:2023-09-30,type_crossref:journal-article|monograph|report</code></p>
<ul>
<li>Ensin suodatan tulokset aikavälille 1.1.2010-30.9.2023</li>
<li>Sitten valitsen vain aikakauslehdet, kirjat tai raportit</li>
</ul>
<p>Näiden jälkeen määritellään maksimitulosmäärä per sivu, eli kaksisataa: <code>&amp;per_page=200</code></p>
<p>Sitten määritellään vielä, mitä me halutaan tuloksistamme. Tässä tilanteessa pyydetään vain otsikkoa, vuotta ja DOI-numeroa: <code>&amp;select=title,publication_year,doi</code></p>
<p>Viimeiseksi voidaan määritellä, mikä sivu tuloksista halutaan. Koska OpenAlexin tulokset tulevat sivuittain (maksimissaan 200 tulosta per sivu), joudumme suorittamaan haun uudelleen jokaiselle tarvittavalle sivulle: <code>&amp;page=1</code>.</p>
<hr>
<p>Hakuosoite kannattaa valmistella hyvin alkeellisessa tekstinkäsittelyohjelmassa, kuten Muistiossa Windows-koneilla. Tämä varmistaa, ettei tekstiin hiivi kummallisia erikoismerkkejä.</p>
<p>Kun olet valmistanut hakuosoitteen, voit kopioida sen selaimen osoitekenttään ja painaa <code>Enter</code> siirtyäksesi tuloksiin. Sinulle avautuu seuraavan kaltainen näkymä:</p>
<div id="fig-openalex-tulossivu" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pics/openalex_tulossivu.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Kuva&nbsp;15.1: OpenAlex-palvelun tuottama tulossivu. Kyseinen sivu on JSON-tiedosto, ja voidaan tallentaa sellaisenaan. Huomaa metatiedot sivun ylälaidasta - tästä näet, tarvitsetko hakea useamman sivun vain riittikö vain yksi.</figcaption>
</figure>
</div>
<p>Ensimmäisenä haussa näet <strong>metatiedot</strong>. Näistä on hyvä heti tarkistaa, kuinka monta tulosta yhteensä löytyy (<strong>count</strong>), ja kirjata tämä dokumentointiin heti tässä vaiheessa.</p>
<p>Tulosmäärän pohjalta tiedät myös, kuinka monta sivua joudut hakemaan. Koska minulla on 1049 tulosta ja 200 tulosta per sivu, joudun hakemaan <code>200 + 200 + 200 + 200 + 200 + 49</code> tulosta, eli suoritan kuusi hakua. Jokaisen haun kohdalla nostan <code>page</code>-määritelmän numeroa (ks. yllä).</p>
<p><strong>Nyt voit myös tarkistaa, toimiko haku niin kuin piti. Jos tulokset näyttävät pahasti vääriltä, muokkaa hakuosoitetta ja yritä uudelleen.</strong></p>
<p>Tallenna yksitellen sivut koneellesi painamalla <code>Ctrl + S</code> tässä näkymässä. Suosittelen nimeämään sivut jotenkin järkevästi, esim. <code>sivu-1</code>, <code>sivu-2</code> jne., jotta pysyt kärryillä lataamistasi sivuista.</p>
<p><strong>Toista nyt hakuprosessi niin monta kertaa, että olet saanut kaikki tuloksesi.</strong></p>
<p>Helpoin tapa varmistaa, että olet hakenut kaikki tulokset, on jatkaa <code>page</code>-numeron nostamista kunnes hakutulokset ovat tyhjiä - tällöin olet mennyt “yli” sivumäärien.</p>
</section>
<section id="tulosten-tallentaminen" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="tulosten-tallentaminen"><span class="header-section-number">15.2</span> Tulosten tallentaminen</h2>
<p>OpenAlex tuottaa JSON-tiedostoja, jotka tulee kääntää taulukkomuotoon Excelin Power Query -työkalulla. Prosessi on melkein sama kuin BASE-hakukoneessa (ks. <a href="tiet-base.html"><span>Luku&nbsp;14</span></a>), mutta eroaa ihan pienesti.</p>
<ul>
<li><p>Avaa tyhjä Excel-taulukko.</p></li>
<li><p>Valitse <code>Tiedot &gt; Nouda tiedot &gt; Tiedostosta &gt; Kohteesta JSON</code>.</p></li>
<li><p>Valitse ensimmäinen ladattu tiedostosi ja paina <code>Tuo</code>.</p></li>
<li><p>Sinulle avautuu Excelin <strong>Power Query</strong> -editori:</p></li>
</ul>
<div id="fig-excel-powerquery-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pics/excel_powerquery.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Kuva&nbsp;15.2: Excelin Power Query -ikkuna. Vasemmalla puolella näet avoimet kyselyt (haettavat tiedostot), keskellä näet nykyisen formatointinäkymän ja oikealla puolella näet muokkausvaiheet. Voit siirtyä eteenpäin ja taaksepäin historiassa muokkausvaihenäkymässä. Yläpalkissa tulee löytymään monia nappeja ja asetuksia joita käytetään JSON-tiedoston oikeassa formatoinnissa taulukkomuotoon.</figcaption>
</figure>
</div>
<p><strong>Toista seuraava prosessi jokaiselle tiedostolle, jonka latasit:</strong></p>
<ul>
<li><p>Löydä rivi <strong>results</strong> ja paina siinä olevaa <strong>List</strong>-tekstiä. Kuvaruutu muuttuu pitkäksi taulukoksi.</p></li>
<li><p>Ylhäältä olevasta valintabannerista, paina <strong>Taulukkoon</strong>-nappia. Esille tulevassa ruudussa, älä muuta mitään ja paina vain <strong>OK</strong>.</p></li>
<li><p>Löydä sarake <strong>Column1</strong> ja paina sen oikeassa laidassa olevaa kahden nuolen kuvaketta. Esille tulevassa ruudussa, älä muuta mitään ja paina vain <strong>OK</strong>.</p></li>
<li><p>Lisätäksesi seuraavan tiedoston: Ylhäältä olevasta valintabannerista, valitse <code>Aloitus &gt; Uusi lähde &gt; Tiedosto &gt; JSON</code>. Löydä seuraava tiedosto ja paina <strong>Tuo</strong>. Aloita formatointi uudestaan.</p></li>
</ul>
<p>Toista yllä oleva prosessi kunnes kaikki ladatut tiedostot ovat listattuna Power Query -ikkunan vasemmassa palkissa. Seuraavaksi yhdistetään kaikki tiedostot yhdeksi:</p>
<ul>
<li><p>Valitse ensimmäinen kysely listasta.</p></li>
<li><p>Navigoi <code>Aloitus &gt; Yhdistä &gt; Liitä kyselyt loppuun</code></p></li>
<li><p>Valitse joko “Kaksi taulukkoa” (jos latasit vain kaksi tiedostoa) tai “Vähintään kolme taulukkoa” (jos latasit useamman kuin kaksi).</p>
<ul>
<li><p>Jos valitsit “Kaksi taulukkoa”: Valitse toinen tiedosto listalta (eli se, jonka latasit ja käsittelit toiseksi).</p></li>
<li><p>Jos valitsit “Vähintään kolme taulukkoa”: Varmista, että kaikki tiedostot löytyvät nimettyinä <strong>Liitettävät taulukot</strong> -alueelta.</p></li>
</ul></li>
<li><p>Paina <strong>OK</strong>. Excel liittää nyt kaikki muut tiedostot ensimmäisen tiedoston taulukkoon.</p></li>
<li><p>Valitse ensimmäinen kysely listalta.</p></li>
<li><p>Valintabannerista, paina <strong>Sulje ja lataa</strong>.</p></li>
</ul>
<p>Excel tekee yhden välilehden jokaiselle taulukolle. Koska me yhdistimme muiden taulukoiden tulokset ensimmäiseen, sinun tulee kopioida <strong>vain</strong> ensimmäisen taulukon välilehden tuloksiisi (<a href="#fig-excel-jsonkasitelty-2">Kuva&nbsp;<span>15.3</span></a>).</p>
<div id="fig-excel-jsonkasitelty-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="pics/excel_jsonkasitelty.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Kuva&nbsp;15.3: Excel-taulukko, josta näkyy käsitellyt JSON-tiedostot Power Query-toiminnon jälkeen. Excel tekee automaattisen Power-taulukon, mutta me voimme yksinkertaisesti vain kopioida tiedot tulostaulukkoomme.</figcaption>
</figure>
</div>
<p>Voit nyt valita kaikki tulokset (vie osoitin soluun <code>A1</code> ja paina <code>Ctrl + oikea</code> valitaksesi seuraavat sarakkeet, ja sitten <code>Ctrl + alas</code> valitaksesi kaikki rivit) ja kopioida ne suoraan tulostaulukkoosi. Muista liittää ne toiminnolla “Liitä arvot”.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopioitu!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopioitu!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tiet-base.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bielefeld Academic Search Engine (BASE)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>